<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Word Magnets</title>
    <link rel="stylesheet" href="magnetic-poetry.css">
    <script>
        // Yes the script tag is in the head section, leave it here.

        { // ES6 Block Scope
            //add varaible to keep reference to what word user is trying to drag
            let selectedElement = null;
            
            //constants for positioning 
            const TRAY_POSITION = {x:50,y:500};
            const MAX_WORD_LEFT = 770;
            const LINE_HEIGHT = 30;
            const WORD_MARGIN =	10;
            const WORD_SPACING = 8;
            const MAX_Z_INDEX = 1000;
            
            //Give the window.onload event handler an anonymous function to call once the window is loaded
            window.onload = function(){
                positionWords();
	           setupStartingPoem();
                setupDragging();
            }
            
            //Create a setStartingPoem() function that will call setPosition()
            function setupStartingPoem(){
	           setPosition(getWord("amazing"),150,100);
                setPosition(getWord("ing"),210,100);
                setPosition(getWord("professor"),253,103);
                setPosition(getWord("do"),350,100);
                setPosition(getWord("is"),390,100);

                setPosition(getWord("student"),200,162);
                setPosition(getWord("totally"),290,162);
                setPosition(getWord("human"),330,160);

                setPosition(getWord("brilliant"),260,230);
                setPosition(getWord("idea"),270,280);
                setPosition(getWord("rock"),275,330);
            }
            
            //Create a setPosition() function for positioning words
            function setPosition(word,wordLeft,wordTop){
	           word.style.left = wordLeft + "px";
	           word.style.top = wordTop + "px";
            }
            //Create a getWord() function that retrieves all of the elements on the page with an id of word, and then loops through them looking for a match
            function getWord(text){
	           let allWords = document.querySelectorAll(".word");
	           for (let word of allWords){
		          if (word.textContent == text){
			         return word; // returns matched word, ends loop
		          }
	           }
            }
            
            //add function to lay out words neatly to bottom of screen and setup mousedown handler
            function positionWords(){
	           let doMousedown = function(e){
		          e.preventDefault();
		          selectedElement = e.target;
		          selectedElement.style.zIndex = MAX_Z_INDEX;
	           };
	           let allWords= document.querySelectorAll(".word");
	           let wordSpacing = WORD_SPACING;
	           let wordLeft = WORD_MARGIN;
	           let wordTop = TRAY_POSITION.y;
	           for (let word of allWords){
		          setPosition(word,wordLeft,wordTop);
		          let wordWidth = word.clientWidth;
		          wordLeft += wordWidth += wordSpacing;
		          if (wordLeft >= MAX_WORD_LEFT){
			         wordLeft = WORD_MARGIN;
			         wordTop += LINE_HEIGHT;
		          }
		          word.onmousedown = doMousedown;
	           }
	           document.querySelector("#title1").onmousedown=doMousedown;
	           document.querySelector("#title2").onmousedown=doMousedown;	document.querySelector("#title3").onmousedown=doMousedown;	document.querySelector("#title4").onmousedown=doMousedown;	document.querySelector("#title5").onmousedown=doMousedown;
            }
            
            //create function to add mouse events ot the document so the user can drag words around
            function setupDragging(){
	           document.onmousemove = function(e){
		          e.preventDefault();
		          if(selectedElement){
			         let mousePos = getMousePos(document.querySelector("#fridge"),e);
                      // adjust position to drag words from center
			         mousePos.x -= selectedElement.clientWidth/2;
			         mousePos.y -= selectedElement.clientHeight/2;
			         setPosition(selectedElement, mousePos.x, mousePos.y);
		          }
	           };
	           document.onmouseup = function(e){
		          if(selectedElement){
			         selectedElement.style.zIndex = MAX_Z_INDEX -1; 
		          }
		          selectedElement = null;
	           };
            }  

            function getMousePos(parentElement,event) {
	           let rect = parentElement.getBoundingClientRect();
	           return {
		          x: event.clientX - rect.left,
		          y: event.clientY - rect.top
	           };
            }
        } // End ES6 Block Scope
    </script>
</head>

<body>
    <div id="container">
        <div id="fridge"></div>
        <div id="sidebar">
            <p class="titleWord" id="title1">Magnetic</p>
            <p class="titleWord" id="title2">Poetry</p>
            <p class="titleWord" id="title3">by</p>
            <p class="titleWord" id="title4">Claire</p>
            <p class="titleWord" id="title5">Koval</p>

        </div>
        <p class="word">a</p>
        <p class="word">absolutely</p>
        <p class="word">always</p>
        <p class="word">am</p>
        <p class="word">amazing</p>
        <p class="word">an</p>
        <p class="word">and</p>
        <p class="word">anything</p>
        <p class="word">are</p>
        <p class="word">are</p>
        <p class="word">awesome</p>
        <p class="word">awesome</p>
        <p class="word">awesomest</p>
        <p class="word">be</p>
        <p class="word">being</p>
        <p class="word">brilliant</p>
        <p class="word">but</p>
        <p class="word">cool</p>
        <p class="word">coolest</p>
        <p class="word">day</p>
        <p class="word">do</p>
        <p class="word">ed</p>
        <p class="word">er</p>
        <p class="word">every</p>
        <p class="word">excellent</p>
        <p class="word">fantastic</p>
        <p class="word">for</p>
        <p class="word">good</p>
        <p class="word">have</p>
        <p class="word">group</p>
        <p class="word">human</p>
        <p class="word">I</p>
        <p class="word">I</p>
        <p class="word">idea</p>
        <p class="word">in</p>
        <p class="word">incredible</p>
        <p class="word">ing</p>
        <p class="word">is</p>
        <p class="word">it</p>
        <p class="word">like</p>
        <p class="word">love</p>
        <p class="word">make</p>
        <p class="word">me</p>
        <p class="word">most</p>
        <p class="word">my</p>
        <p class="word">of</p>
        <p class="word">or</p>
        <p class="word">our</p>
        <p class="word">perfect</p>
        <p class="word">person</p>
        <p class="word">possible</p>
        <p class="word">professor</p>
        <p class="word">project</p>
        <p class="word">rock</p>
        <p class="word">s</p>
        <p class="word">she</p>
        <p class="word">so</p>
        <p class="word">student</p>
        <p class="word">super</p>
        <p class="word">take</p>
        <p class="word">the</p>
        <p class="word">best</p>
        <p class="word">thing</p>
        <p class="word">this</p>
        <p class="word">to</p>
        <p class="word">totally</p>
        <p class="word">us</p>
        <p class="word">we</p>
        <p class="word">with</p>
        <p class="word">web</p>
        <p class="word">work</p>
        <p class="word">you</p>
        <p class="word">your</p>
    </div>
</body>

</html>